# å³æ—¶é€šè®¯åŠŸèƒ½ - é¡¹ç›®æ–‡æ¡£

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

åŸºäºVue 3 + Element Pluså¼€å‘çš„ç°ä»£åŒ–å³æ—¶é€šè®¯ç³»ç»Ÿï¼Œæä¾›å®Œæ•´çš„èŠå¤©ã€å¥½å‹ç®¡ç†ã€ç¾¤ç»„ç®¡ç†åŠŸèƒ½ã€‚ç³»ç»Ÿé‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œæ”¯æŒå•èŠã€ç¾¤èŠã€å¥½å‹ç”³è¯·å¤„ç†ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚

### âœ¨ æ ¸å¿ƒç‰¹æ€§

- **ğŸ’¬ å®æ—¶æ¶ˆæ¯é€šä¿¡** - æ”¯æŒæ–‡æœ¬ã€å›¾ç‰‡æ¶ˆæ¯å‘é€
- **ğŸ‘¥ å¥½å‹ç®¡ç†** - å®Œæ•´çš„æ·»åŠ ã€åˆ é™¤ã€é»‘åå•åŠŸèƒ½
- **ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ ç¾¤ç»„ç®¡ç†** - åˆ›å»ºã€ç®¡ç†ç¾¤ç»„ï¼Œç¾¤èŠæ¶ˆæ¯æ”¯æŒ
- **ğŸ“± ç°ä»£åŒ–UI** - åŸºäºElement Plusçš„ä¼˜é›…ç•Œé¢è®¾è®¡
- **ğŸ”’ ç”¨æˆ·è®¤è¯** - é›†æˆç”¨æˆ·è®¤è¯ç³»ç»Ÿ
- **ğŸ“Š æ¶ˆæ¯å†å²** - å®Œæ•´çš„èŠå¤©è®°å½•ç®¡ç†

## ğŸ—‚ï¸ é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ api/
â”‚   â””â”€â”€ im.js                    # å³æ—¶é€šè®¯APIæ¥å£å°è£…
â”œâ”€â”€ views/
â”‚   â””â”€â”€ instantMessaging/
â”‚       â”œâ”€â”€ index.vue            # ä¸»é¡µé¢ - å³æ—¶é€šè®¯å…¥å£
â”‚       â”œâ”€â”€ TestPage.vue         # æµ‹è¯•é¡µé¢ - APIåŠŸèƒ½éªŒè¯
â”‚       â””â”€â”€ components/
â”‚           â”œâ”€â”€ FriendList.vue           # å¥½å‹åˆ—è¡¨ç»„ä»¶
â”‚           â”œâ”€â”€ GroupList.vue            # ç¾¤ç»„åˆ—è¡¨ç»„ä»¶
â”‚           â”œâ”€â”€ FriendRequestList.vue   # å¥½å‹ç”³è¯·å¤„ç†ç»„ä»¶
â”‚           â””â”€â”€ ChatWindow.vue           # èŠå¤©çª—å£ç»„ä»¶
â””â”€â”€ stores/
    â””â”€â”€ auth.js                  # ç”¨æˆ·è®¤è¯çŠ¶æ€ç®¡ç†
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js 16+
- npm æˆ– pnpm
- Vue 3.0+
- Element Plus 2.0+

### å®‰è£…ä¾èµ–
```bash
npm install
# æˆ–
pnpm install
```

### å¯åŠ¨å¼€å‘æœåŠ¡å™¨
```bash
npm run dev
# è®¿é—® http://localhost:9527
```

## ğŸ“¡ APIæ¥å£æ–‡æ¡£

### å³æ—¶é€šè®¯æ¥å£

#### æ¶ˆæ¯å‘é€
- `sendSingleMessageByParam(data)` - å‘é€å•èŠæ¶ˆæ¯ï¼ˆå‚æ•°æ–¹å¼ï¼‰
- `sendSingleMessage(data)` - å‘é€å•èŠæ¶ˆæ¯ï¼ˆå®ä½“æ–¹å¼ï¼‰
- `sendGroupMessageByParam(data)` - å‘é€ç¾¤èŠæ¶ˆæ¯ï¼ˆå‚æ•°æ–¹å¼ï¼‰

#### æ¶ˆæ¯å†å²
- `getSingleChatHistory(params)` - è·å–å•èŠå†å²æ¶ˆæ¯
- `getGroupChatHistory(params)` - è·å–ç¾¤èŠå†å²æ¶ˆæ¯

#### å¥½å‹ç®¡ç†
- `sendFriendRequest(data)` - å‘é€å¥½å‹ç”³è¯·
- `getFriendList(params)` - è·å–å¥½å‹åˆ—è¡¨
- `getPendingFriendRequests(params)` - è·å–å¾…å¤„ç†å¥½å‹ç”³è¯·
- `acceptFriendRequest(data)` - æ¥å—å¥½å‹ç”³è¯·
- `rejectFriendRequest(data)` - æ‹’ç»å¥½å‹ç”³è¯·
- `deleteFriend(data)` - åˆ é™¤å¥½å‹
- `blockFriend(data)` - åŠ å…¥é»‘åå•
- `setSpecialFriend(data)` - è®¾ç½®ç‰¹åˆ«å…³å¿ƒ

### ç¾¤ç»„ç®¡ç†æ¥å£
- `getChatGroupById(id)` - æ ¹æ®IDæŸ¥è¯¢ç¾¤ç»„
- `getChatGroupsByCreator(creatorId)` - æ ¹æ®åˆ›å»ºè€…IDæŸ¥è¯¢ç¾¤ç»„
- `searchChatGroups(params)` - æ ¹æ®åç§°æœç´¢ç¾¤ç»„
- `createChatGroup(data)` - åˆ›å»ºç¾¤ç»„
- `updateChatGroup(data)` - æ›´æ–°ç¾¤ç»„ä¿¡æ¯
- `deleteChatGroup(id)` - åˆ é™¤ç¾¤ç»„

## ğŸ¯ ä½¿ç”¨æŒ‡å—

### 1. åŠŸèƒ½æµ‹è¯•
è®¿é—® `/im/test` é¡µé¢è¿›è¡ŒAPIè¿æ¥æµ‹è¯•ï¼š
- âœ… éªŒè¯APIè¿æ¥çŠ¶æ€
- âœ… æµ‹è¯•æ¶ˆæ¯å‘é€åŠŸèƒ½
- âœ… æ£€æŸ¥æ¥å£å“åº”æ ¼å¼

### 2. ä¸»åŠŸèƒ½é¡µé¢
è®¿é—® `/im` é¡µé¢ä½¿ç”¨å®Œæ•´å³æ—¶é€šè®¯åŠŸèƒ½ï¼š

**å·¦ä¾§é¢æ¿åŠŸèƒ½ï¼š**
- **èŠå¤©** - å¥½å‹åˆ—è¡¨ï¼Œæ”¯æŒæœç´¢å’Œé€‰æ‹©èŠå¤©
- **è”ç³»äºº** - ç¾¤ç»„åˆ—è¡¨ï¼Œæ”¯æŒåˆ›å»ºå’Œç®¡ç†ç¾¤ç»„
- **å‘ç°** - å¥½å‹ç”³è¯·å¤„ç†ï¼Œæ”¯æŒæ¥å—/æ‹’ç»ç”³è¯·

**å³ä¾§èŠå¤©åŒºåŸŸï¼š**
- å®æ—¶æ¶ˆæ¯æ˜¾ç¤º
- æ”¯æŒæ–‡æœ¬å’Œå›¾ç‰‡æ¶ˆæ¯å‘é€
- æ¶ˆæ¯æ—¶é—´æˆ³æ˜¾ç¤º
- åœ¨çº¿çŠ¶æ€æŒ‡ç¤º

### 3. æ¶ˆæ¯ç±»å‹æ”¯æŒ

#### æ–‡æœ¬æ¶ˆæ¯
```javascript
{
  senderId: 1,
  receiverId: 2,
  content: "Hello World",
  messageType: "TEXT"
}
```

#### å›¾ç‰‡æ¶ˆæ¯
```javascript
{
  senderId: 1,
  receiverId: 2,
  content: "[å›¾ç‰‡]",
  image: "data:image/png;base64,...",
  messageType: "IMAGE"
}
```

## âš™ï¸ é…ç½®è¯´æ˜

### åŸºç¡€URLé…ç½®
åœ¨ `src/api/im.js` ä¸­é…ç½®APIè¯·æ±‚çš„åŸºç¡€URLï¼š
```javascript
// å¼€å‘ç¯å¢ƒé…ç½®
const baseURL = 'http://localhost:2025/api/public'

// ç”Ÿäº§ç¯å¢ƒé…ç½®ï¼ˆåœ¨.env.productionä¸­è®¾ç½®ï¼‰
VITE_API_BASE_URL=https://your-api-domain.com/api/public
```

### ç”¨æˆ·è®¤è¯é›†æˆ
å½“å‰ç‰ˆæœ¬å·²é›†æˆç”¨æˆ·è®¤è¯ç³»ç»Ÿï¼Œä» `authStore` è·å–ç”¨æˆ·ä¿¡æ¯ï¼š
```javascript
import { useAuthStore } from '@/stores/auth.js'
const authStore = useAuthStore()
const userId = authStore.user?.id
```

### æ¶ˆæ¯æ ¼å¼é…ç½®
æ‰€æœ‰æ¶ˆæ¯éµå¾ªç»Ÿä¸€æ ¼å¼ï¼š
```javascript
{
  id: number,           // æ¶ˆæ¯ID
  content: string,      // æ¶ˆæ¯å†…å®¹
  messageType: string,  // æ¶ˆæ¯ç±»å‹ï¼šTEXT/IMAGE
  timestamp: number,    // æ—¶é—´æˆ³
  isSelf: boolean,      // æ˜¯å¦è‡ªå·±å‘é€
  image?: string        // å›¾ç‰‡æ•°æ®ï¼ˆä»…IMAGEç±»å‹ï¼‰
}
```

## ğŸ› ï¸ æŠ€æœ¯æ¶æ„

### å‰ç«¯æŠ€æœ¯æ ˆ
- **Vue 3** - æ¸è¿›å¼JavaScriptæ¡†æ¶
- **Composition API** - ç»„åˆå¼APIï¼Œæ›´å¥½çš„é€»è¾‘å¤ç”¨
- **Element Plus** - ä¼ä¸šçº§UIç»„ä»¶åº“
- **Vue Router** - å®˜æ–¹è·¯ç”±ç®¡ç†å™¨
- **Pinia** - çŠ¶æ€ç®¡ç†åº“
- **Axios** - HTTPè¯·æ±‚åº“
- **`<script setup>`** - ç¼–è¯‘æ—¶è¯­æ³•ç³–

### å¼€å‘ç‰¹æ€§
- **æ¨¡å—åŒ–è®¾è®¡** - ç»„ä»¶åŒ–å¼€å‘ï¼Œæ˜“äºç»´æŠ¤å’Œæ‰©å±•
- **TypeScriptæ”¯æŒ** - å®Œæ•´çš„ç±»å‹æ”¯æŒï¼ˆå¯é€‰ï¼‰
- **å“åº”å¼è®¾è®¡** - æ”¯æŒç§»åŠ¨ç«¯å’Œæ¡Œé¢ç«¯
- **å›½é™…åŒ–** - æ”¯æŒå¤šè¯­è¨€ï¼ˆåŸºäºElement Plusï¼‰

## ğŸ“Š æ¥å£è§„èŒƒ

### è¯·æ±‚æ ¼å¼
æ‰€æœ‰APIè¯·æ±‚ä½¿ç”¨ç»Ÿä¸€çš„è¯·æ±‚æ ¼å¼ï¼š
```javascript
// GETè¯·æ±‚
const response = await getFriendList({ userId: 1 })

// POSTè¯·æ±‚  
const response = await sendSingleMessage({
  senderId: 1,
  receiverId: 2,
  content: "Hello",
  messageType: "TEXT"
})
```

### å“åº”æ ¼å¼
æ‰€æœ‰æ¥å£éµå¾ªç»Ÿä¸€çš„å“åº”æ ¼å¼ï¼š
```json
{
  "code": 200,           // çŠ¶æ€ç ï¼š200æˆåŠŸï¼Œå…¶ä»–ä¸ºé”™è¯¯
  "message": "æˆåŠŸ",     // æç¤ºä¿¡æ¯
  "data": {             // è¿”å›æ•°æ®
    "id": 1,
    "username": "user1",
    "avatar": "avatar-url"
  }
}
```

### é”™è¯¯ä»£ç 
- `200` - è¯·æ±‚æˆåŠŸ
- `400` - è¯·æ±‚å‚æ•°é”™è¯¯
- `401` - æœªæˆæƒè®¿é—®  
- `403` - ç¦æ­¢è®¿é—®
- `404` - èµ„æºä¸å­˜åœ¨
- `500` - æœåŠ¡å™¨å†…éƒ¨é”™è¯¯
- `503` - æœåŠ¡ä¸å¯ç”¨

## ğŸ¨ UIç»„ä»¶è¯´æ˜

### ChatWindow ç»„ä»¶
ä¸»è¦èŠå¤©çª—å£ï¼Œæ”¯æŒï¼š
- æ¶ˆæ¯å‘é€å’Œæ¥æ”¶æ˜¾ç¤º
- å›¾ç‰‡æ¶ˆæ¯é¢„è§ˆ
- è¡¨æƒ…é€‰æ‹©å™¨
- æ¶ˆæ¯æ—¶é—´æ ¼å¼åŒ–
- æ»šåŠ¨åˆ°æœ€æ–°æ¶ˆæ¯

### FriendList ç»„ä»¶
å¥½å‹åˆ—è¡¨ç®¡ç†ï¼ŒåŠŸèƒ½åŒ…æ‹¬ï¼š
- å¥½å‹æœç´¢å’Œè¿‡æ»¤
- åœ¨çº¿çŠ¶æ€æ˜¾ç¤º
- å¥½å‹é€‰æ‹©èŠå¤©
- åˆ—è¡¨åˆ·æ–°åŠŸèƒ½

### GroupList ç»„ä»¶  
ç¾¤ç»„ç®¡ç†ï¼Œæ”¯æŒï¼š
- ç¾¤ç»„åˆ›å»ºå’Œæœç´¢
- ç¾¤ç»„æˆå‘˜ç®¡ç†
- ç¾¤ç»„é€‰æ‹©èŠå¤©

### FriendRequestList ç»„ä»¶
å¥½å‹ç”³è¯·å¤„ç†ï¼š
- ç”³è¯·åˆ—è¡¨æ˜¾ç¤º
- æ¥å—/æ‹’ç»æ“ä½œ
- ç”³è¯·çŠ¶æ€æ›´æ–°

## ğŸ”§ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°æ¶ˆæ¯ç±»å‹
1. åœ¨ `im.js` ä¸­æ·»åŠ å¯¹åº”çš„APIæ¥å£
2. åœ¨ `ChatWindow.vue` ä¸­æ·»åŠ æ¶ˆæ¯å¤„ç†é€»è¾‘
3. æ›´æ–°æ¶ˆæ¯æ¸²æŸ“ç»„ä»¶æ”¯æŒæ–°ç±»å‹
4. æ·»åŠ å¯¹åº”çš„CSSæ ·å¼

### é›†æˆWebSocket
```javascript
// ç¤ºä¾‹WebSocketé›†æˆ
const setupWebSocket = (userId) => {
  const ws = new WebSocket(`ws://localhost:2025/ws?userId=${userId}`)
  
  ws.onmessage = (event) => {
    const message = JSON.parse(event.data)
    // å¤„ç†å®æ—¶æ¶ˆæ¯
  }
  
  ws.onclose = () => {
    // é‡è¿é€»è¾‘
  }
}
```

### è‡ªå®šä¹‰ä¸»é¢˜
ä¿®æ”¹Element Plusä¸»é¢˜å˜é‡ï¼š
```scss
// åœ¨CSSæ–‡ä»¶ä¸­è¦†ç›–ä¸»é¢˜å˜é‡
:root {
  --el-color-primary: #07c160;
  --el-color-success: #67c23a;
  --el-color-warning: #e6a23c;
  --el-color-danger: #f56c6c;
}
```

## ğŸš€ æ€§èƒ½ä¼˜åŒ–

### æ¶ˆæ¯åˆ—è¡¨ä¼˜åŒ–
- è™šæ‹Ÿæ»šåŠ¨æ”¯æŒå¤§é‡æ¶ˆæ¯
- æ¶ˆæ¯åˆ†é¡µåŠ è½½
- å›¾ç‰‡æ‡’åŠ è½½

### ç½‘ç»œä¼˜åŒ–
- è¯·æ±‚é˜²æŠ–å¤„ç†
- å›¾ç‰‡å‹ç¼©ä¸Šä¼ 
- WebSocketè¿æ¥å¤ç”¨

### å†…å­˜ç®¡ç†
- æ¶ˆæ¯ç¼“å­˜æ¸…ç†
- å›¾ç‰‡èµ„æºé‡Šæ”¾
- äº‹ä»¶ç›‘å¬å™¨æ¸…ç†

## ğŸ“± æµè§ˆå™¨å…¼å®¹æ€§

### æ”¯æŒæµè§ˆå™¨
- Chrome 88+
- Firefox 85+
- Safari 14+
- Edge 88+

### ç§»åŠ¨ç«¯æ”¯æŒ
- iOS Safari 14+
- Android Chrome 88+
- å“åº”å¼è®¾è®¡é€‚é…

## ğŸ”® åç»­å¼€å‘è®¡åˆ’

### çŸ­æœŸä¼˜åŒ–
- [ ] æ¶ˆæ¯å·²è¯»/æœªè¯»çŠ¶æ€æ˜¾ç¤º
- [ ] æ¶ˆæ¯æ’¤å›åŠŸèƒ½
- [ ] æ¶ˆæ¯è¡¨æƒ…å›å¤
- [ ] èŠå¤©è®°å½•æœç´¢

### ä¸­æœŸåŠŸèƒ½  
- [ ] è¯­éŸ³æ¶ˆæ¯æ”¯æŒ
- [ ] è§†é¢‘é€šè¯é›†æˆ
- [ ] æ–‡ä»¶ä¼ è¾“åŠŸèƒ½
- [ ] æ¶ˆæ¯åŠ å¯†ä¼ è¾“

### é•¿æœŸè§„åˆ’
- [ ] å¤šç«¯æ¶ˆæ¯åŒæ­¥
- [ ] æ¶ˆæ¯äº‘ç«¯å¤‡ä»½
- [ ] æ™ºèƒ½æ¶ˆæ¯æ¨è
- [ ] ç¾¤ç»„è¯­éŸ³èŠå¤©

## ğŸ› å¸¸è§é—®é¢˜

### Q: å›¾æ ‡ä¸æ˜¾ç¤ºæ€ä¹ˆåŠï¼Ÿ
A: ç¡®ä¿å·²æ­£ç¡®æ³¨å†ŒElement Pluså›¾æ ‡ç»„ä»¶ï¼š
```javascript
// åœ¨main.jsä¸­æ³¨å†Œå›¾æ ‡
import * as ElementPlusIconsVue from '@element-plus/icons-vue'
for (const [key, component] of Object.entries(ElementPlusIconsVue)) {
  app.component(key, component)
}
```

### Q: æ¶ˆæ¯å‘é€å¤±è´¥ï¼Ÿ
A: æ£€æŸ¥APIæœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œï¼Œç¡®è®¤baseURLé…ç½®æ­£ç¡®ã€‚

### Q: ç”¨æˆ·è®¤è¯å¤±è´¥ï¼Ÿ
A: ç¡®ä¿ç”¨æˆ·å·²ç™»å½•ï¼Œæ£€æŸ¥localStorageä¸­çš„ç”¨æˆ·ä¿¡æ¯ã€‚

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäºMITè®¸å¯è¯å¼€æºï¼Œæ¬¢è¿è´¡çŒ®ä»£ç å’Œæå‡ºå»ºè®®ã€‚

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork æœ¬é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯Pull Request

## ğŸ“ æŠ€æœ¯æ”¯æŒ

- æ–‡æ¡£ï¼šæœ¬é¡¹ç›®README
- é—®é¢˜ï¼šGitHub Issues
- é‚®ç®±ï¼šå¼€å‘å›¢é˜Ÿè”ç³»æ–¹å¼

---

*æœ€åæ›´æ–°: 2025å¹´9æœˆ*
*ç‰ˆæœ¬: v1.0.0*